<!DOCTYPE html>
<html>
  <head>
      
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- ç™¾åº¦éªŒè¯ -->
<meta name="baidu-site-verification" content="1IkquSGR9Z"/>

<title>Acey</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<meta name="description" content="ç»ˆèº«å­¦ä¹ å®è·µè€…"/>
<meta name="keywords" content="ç»ˆèº«å­¦ä¹ å®è·µè€…"/>

<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
<link rel="shortcut icon" href="https://aceysx.github.io/favicon.ico">

<link rel="stylesheet" href="https://aceysx.github.io/styles/main.css">

<!-- Modernizr JS -->
<script src="https://aceysx.github.io/media/scripts/_vendors/modernizr-2.6.2.min.js"></script>
<!-- FOR IE9 below -->
<!--[if lt IE 9]>
<scripts src="https://aceysx.github.io/media/scripts/_vendors/respond.min.js"></scripts>
<![endif]-->

<!-- Comment -->

    
        <link href="https://cdn.bootcss.com/gitalk/1.5.0/gitalk.min.css" rel="stylesheet">
    

    


<script src="https://cdn.bootcss.com/highlight.js/9.15.8/highlight.min.js"></script>

<link crossorigin="anonymous" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" href="https://lib.baomitu.com/font-awesome/5.8.1/css/all.min.css" rel="stylesheet">

  </head>
  <body>
  
<div id="fh5co-offcanvas">
    <a href="#!" class="fh5co-close-offcanvas js-fh5co-close-offcanvas">
        <span><i class="icon-cross3"></i> <span>Close</span></span>
    </a>
    <div class="fh5co-bio">
        <figure>
            <img src="https://aceysx.github.io/media/images/avatar.png" alt="Acey" class="img-responsive">
        </figure>
        <h3 class="heading">ABOUT ME</h3>
        <h2>Acey</h2>
        <p>ç»ˆèº«å­¦ä¹ å®è·µè€…</p>
        <ul class="fh5co-social">
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
        </ul>
    </div>

    <div class="fh5co-menu">
        <div class="fh5co-box">
            <h3 class="heading">æœç´¢</h3>
            <form action="#">
                <div class="form-group">
                    <input type="text" id="bdcsMain" class="form-control" placeholder="è¾“å…¥å…³é”®å­—">
<!--                    <button type="submit" class="btn btn-sm btn-warning" style="margin-top: 6px; width: 100%">ç‚¹å‡»æœç´¢</button>-->
                </div>
            </form>
        </div>
        <div class="fh5co-box">
            <h3 class="heading">æ ‡ç­¾</h3>
            <ul>
                
                    <li><a href="https://aceysx.github.io/tag/a9_btR17J">java</a></li>
                
                    <li><a href="https://aceysx.github.io/tag/xDOTW_ajF">æºç </a></li>
                
                    <li><a href="https://aceysx.github.io/tag/H7zClUp1Zn">Java</a></li>
                
                    <li><a href="https://aceysx.github.io/tag/d7JtpZe_Z">åŸ¹è®­</a></li>
                
                    <li><a href="https://aceysx.github.io/tag/YZTSYsotq">semver</a></li>
                
                    <li><a href="https://aceysx.github.io/tag/c7FOkgyJb">é˜…è¯»</a></li>
                
                    <li><a href="https://aceysx.github.io/tag/yj-SRumhW">CI/CD</a></li>
                
                    <li><a href="https://aceysx.github.io/tag/Prn9CdFMe">æ²Ÿé€š</a></li>
                
                    <li><a href="https://aceysx.github.io/tag/ZaVixV3aXn">å†™ä½œ</a></li>
                
                    <li><a href="https://aceysx.github.io/tag/mTR3MtR3C">å®è·µ</a></li>
                
                    <li><a href="https://aceysx.github.io/tag/lLpswgN2-">è¿åŠ¨</a></li>
                
            </ul>
        </div>
    </div>
</div>

<header id="fh5co-header">
    <div class="container-fluid">
        <div class="row">
            <a href="#" class="js-fh5co-nav-toggle fh5co-nav-toggle"><i></i></a>
            <ul class="fh5co-social">
                
                    <li>
                        <a href="/"
                         >
                            é¦–é¡µ
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives"
                         >
                            å½’æ¡£
                        </a>
                    </li>
                
                    <li>
                        <a href="/tags"
                         >
                            æ ‡ç­¾
                        </a>
                    </li>
                
                    <li>
                        <a href="https://aceysx.github.io/post/about/index.html"
                         >
                            å…³äº
                        </a>
                    </li>
                
                    <li>
                        <a href="https://github.com/Aceysx"
                        
                           target="_blank"
                                 >
                            Github
                        </a>
                    </li>
                
            </ul>
            <div class="col-lg-12 col-md-12 text-center">
                <h1 id="fh5co-logo">
                    <a href="https://aceysx.github.io">Acey </a>
                </h1>
            </div>
        </div>
    </div>
</header>


<!--  <a href="#" class="fh5co-post-prev"><span>ğŸ‘ˆ Prev</span></a>-->
<!--  <a href="#" class="fh5co-post-next"><span>Next ğŸ‘‰</span></a>-->

  <div class="container-fluid">
      <div class="row fh5co-post-entry single-entry">
          <article class="col-lg-8 col-lg-offset-2 col-md-8 col-md-offset-2 col-sm-8 col-sm-offset-2 col-xs-12 col-xs-offset-0">
              <figure class="animate-box">
                  
                      <img src="https://upload-images.jianshu.io/upload_images/3126293-a05fc30d61ecb0a5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ã€ŒOpenJdk-11 æºç -ç³»åˆ—ã€ ArrayList" class="img-responsive">
                  
              </figure>
              <span class="fh5co-meta animate-box">
                  
                      <div class="tag-container">
                          
                              <a href="https://aceysx.github.io/tag/a9_btR17J" class="tag">java, </a>
                          
                              <a href="https://aceysx.github.io/tag/xDOTW_ajF" class="tag">æºç , </a>
                          
                      </div>
                  
              </span>
              <h2 class="fh5co-article-title animate-box">ã€ŒOpenJdk-11 æºç -ç³»åˆ—ã€ ArrayList</h2>
              <span class="fh5co-meta fh5co-date animate-box">2019-09-08</span>

              <div class="col-lg-12 col-lg-offset-0 col-md-12 col-md-offset-0 col-sm-12 col-sm-offset-0 col-xs-12 col-xs-offset-0 text-left content-article">
                  <div class="row">
                      <div class="col-md-12 animate-box post-content">
                          <p> <h2 id="arraylist-å®šä¹‰">ArrayList å®šä¹‰</h2>
<pre><code class="language-java">public class ArrayList&lt;E&gt; extends AbstractList&lt;E&gt;
	implements List&lt;E&gt;, RandomAccess, Cloneable, java.io.Serializable{
	
	private static final int DEFAULT_CAPACITY = 10;
	private static final Object[] EMPTY_ELEMENTDATA = {};
	private static final Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = {};
	transient Object[] elementData;
	private int size;
}
</code></pre>
<p>é¦–å…ˆå¯ä»¥çœ‹åˆ°<code>ArrayList</code>ç»§æ‰¿äº†<code>AbstractList</code>å¹¶å®ç°äº†<code>List</code>ï¼Œä¹Ÿå°±æ˜¯è¯´<code>ArrayList</code>æ˜¯ä¸€ä¸ªæ•°ç»„é˜Ÿåˆ—ï¼Œæ‹¥æœ‰äº†åŸºæœ¬çš„å¢åˆ æ”¹æŸ¥ï¼Œéå†çš„æ“ä½œã€‚</p>
<p>åŒæ—¶å®ç°äº†</p>
<ul>
<li><code>Cloneable</code>æ¥å£ï¼Œå³å¯ä»¥è¢«<code>clone</code></li>
<li><code>Serializable</code>æ¥å£ï¼Œæ„å‘³ç€å¯ä»¥è¢«<a href="https://juejin.im/post/5d6d4107e51d453b5f1a04dc">åºåˆ—åŒ–</a></li>
<li><code>RandomAccess</code>æ¥å£ï¼Œ<code>RandomAccess</code>æ¥å£æ˜¯ä¸€ä¸ªç©ºçš„æ¥å£ï¼Œå’Œ<code>Serializable</code>æ¥å£ä¸€æ ·ï¼Œä¹Ÿæ˜¯ä½œä¸ºä¸€ä¸ªæ ‡è¯†ï¼Œå³å¯ä»¥å¿«é€Ÿè®¿é—®ï¼Œå¯¹äº<code>ArrayList</code>æ¥è¯´ï¼Œå°±æ˜¯å¯ä»¥é€šè¿‡ä¸‹æ ‡æ¥è®¿é—®å…ƒç´ ã€‚è€Œ<code>LinkedList</code>å°±æ²¡æœ‰å®ç°è¿™*ä¸ªæ¥å£ã€‚</li>
</ul>
<h4 id="default_capacity-å’Œ-size-çš„å…³ç³»"><strong>DEFAULT_CAPACITY å’Œ size çš„å…³ç³»</strong></h4>
<p>æ ¹æ®å®˜æ–¹æ³¨è§£çŸ¥é“ï¼Œ<code>DEFAULT_CAPACITY</code>æ˜¯æ•°ç»„æ€»ç©ºé—´å¤§å°ï¼Œè€Œ<code>size</code>æ˜¯æ•°ç»„çš„å½“å‰çš„å®¹é‡çš„å¤§å°ã€‚ä¸¾ä¸ªä¾‹å­æ¥è¯´ï¼Œä¸€ä¸ªå¯ä»¥è£…1Læ°´çš„æ¯å­ï¼Œé‚£ä¹ˆ<code>DEFAULT_CAPACITY</code>å°±æ˜¯1Lï¼Œæˆ‘ä»¬ç°åœ¨å¾€æ¯å­é‡Œå€’å…¥äº†0.5Læ°´ï¼Œé‚£ä¹ˆ<code>size</code>å°±æ˜¯0.5Lã€‚å½“ç„¶åœ¨è¿™ï¼Œ<code>DEFAULT_CAPACITY</code>çš„é»˜è®¤å€¼æ˜¯10ï¼Œå½“<code>size</code>&gt;10çš„æ—¶å€™ï¼Œä¼šè¿›è¡Œæ‰©å®¹ã€‚</p>
<h4 id="ä¸ºæ’’-elementdata-éœ€è¦-transient-è¿›è¡Œä¿®é¥°"><strong>ä¸ºæ’’ elementData éœ€è¦ transient è¿›è¡Œä¿®é¥°</strong></h4>
<p>åˆšæ‰æˆ‘ä»¬è®²åˆ°<code>ArrayList</code>å†…éƒ¨å…¶å®å°±æ˜¯ç”¨äº†ä¸€ä¸ª<code>Object[]</code>æ¥è¿›è¡Œç»´æŠ¤æ•°æ®ï¼Œé‚£æ—¢ç„¶æˆ‘ä»¬å·²ç»å®ç°äº†<code>Serializable</code>æ¥å£ï¼Œé‚£ä¸ºæ’’è¿˜è¦ç”¨<code>transient</code>æ¥ä¿®é¥°<code>elementData</code>å‘¢ï¼Ÿæ¥çœ‹çœ‹åºåˆ—åŒ–/ååºåˆ—åŒ–çš„ä»£ç </p>
<pre><code class="language-java"> 	private void readObject(java.io.ObjectInputStream s)
        throws java.io.IOException, ClassNotFoundException {

        // Read in size, and any hidden stuff
        s.defaultReadObject();

        // Read in capacity
        s.readInt(); // ignored

        if (size &gt; 0) {
            // like clone(), allocate array based upon size not capacity
            SharedSecrets.getJavaObjectInputStreamAccess().checkArray(s, Object[].class, size);
            Object[] elements = new Object[size];

            // Read in all elements in the proper order.
            for (int i = 0; i &lt; size; i++) {
                elements[i] = s.readObject();
            }

            elementData = elements;
        } else if (size == 0) {
            elementData = EMPTY_ELEMENTDATA;
        } else {
            throw new java.io.InvalidObjectException(&quot;Invalid size: &quot; + size);
        }
    }

	private void writeObject(java.io.ObjectOutputStream s)
        throws java.io.IOException {
        // Write out element count, and any hidden stuff
        int expectedModCount = modCount;
        s.defaultWriteObject();

        // Write out size as capacity for behavioral compatibility with clone()
        s.writeInt(size);

        // Write out all elements in the proper order.
        for (int i=0; i&lt;size; i++) {
            s.writeObject(elementData[i]);
        }

        if (modCount != expectedModCount) {
            throw new ConcurrentModificationException();
        }
    }
</code></pre>
<p><code>ArrayList</code>åœ¨åºåˆ—åŒ–çš„æ—¶å€™ä¼šè°ƒç”¨<code>writeObject</code>æ–¹æ³•ï¼Œå°†æ•°ç»„çš„<code>size</code>å’Œ<code>elementData</code>å†™å…¥<code>ObjectOutputStream</code>ï¼Œ</p>
<p>åœ¨ååºåˆ—åŒ–æ—¶è°ƒç”¨<code>readObject</code>ï¼Œä»<code>ObjectInputStream</code>è·å–<code>size</code>å’Œ<code>elementData</code>ï¼Œå†æ¢å¤åˆ°<code>elementData</code>.</p>
<p>è¿™æ ·å°±å¯ä»¥å¾ˆå¥½çš„èŠ‚çœç©ºé—´å’Œæ—¶é—´ã€‚å› ä¸º<code>elementData</code>æ•´ä¸ªçš„å¤§å°æ˜¯<code>CAPACITY</code>ï¼Œä¸€èˆ¬æƒ…å†µä¸‹éƒ½ä¼šé¢„ç•™ä¸€äº›å®¹é‡ï¼Œæˆ‘ä»¬çœŸæ­£éœ€è¦åºåˆ—åŒ–/ååºåˆ—åŒ–çš„åªæ˜¯å½“å‰å­˜å…¥çš„æ•°æ®ã€‚</p>
<h2 id="æ„é€ æ–¹æ³•">æ„é€ æ–¹æ³•</h2>
<h4 id="æ— å‚æ„é€ æ–¹æ³•">æ— å‚æ„é€ æ–¹æ³•</h4>
<pre><code class="language-java">
    public ArrayList() {
        this.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;
    }

    public ArrayList(int initialCapacity) {
        if (initialCapacity &gt; 0) {
            this.elementData = new Object[initialCapacity];
        } else if (initialCapacity == 0) {
            this.elementData = EMPTY_ELEMENTDATA;
        } else {
            throw new IllegalArgumentException(&quot;Illegal Capacity: &quot;+
                                               initialCapacity);
        }
    }

	 public ArrayList(Collection&lt;? extends E&gt; c) {
        elementData = c.toArray();
        if ((size = elementData.length) != 0) {
            if (elementData.getClass() != Object[].class)
                elementData = Arrays.copyOf(elementData, size, Object[].class);
        } else {
            // replace with empty array.
            this.elementData = EMPTY_ELEMENTDATA;
        }
    }
</code></pre>
<p>ç¬¬ä¸€ä¸ªç©ºå‚æ„é€ å‡½æ•°ï¼Œä¼šé»˜è®¤å°†<code>DEFAULTCAPACITY_EMPTY_ELEMENTDATA</code>çš„å¼•ç”¨ä¼ å…¥<code>elementData</code>ã€‚åœ¨ç¬¬ä¸€æ¬¡æ·»åŠ å…ƒç´ çš„æ—¶å€™ä¼šæ‰©å®¹ä¸€ä¸ªå®¹é‡ä¸º10çš„æ•°ç»„ã€‚</p>
<p>ç¬¬äºŒä¸ªæŒ‡å®šåˆå§‹åŒ–çš„ <code>capacity</code>æ¥åˆ›å»º <code>elementData</code>, ä¸€èˆ¬æ¨èä½¿ç”¨è¿™ç§æ–¹å¼æ¥åˆ›å»º<code>ArrayList</code>ï¼Œå‡å°‘æ‰©å®¹å¸¦æ¥çš„å†…å­˜å¼€é”€ã€‚</p>
<p>ç¬¬ä¸‰ä¸ªåˆ™æ˜¯ä¼ å…¥ä¸€ä¸ª<code>Collection</code>æ¥åˆ›å»º<code>elementData</code></p>
<h2 id="æ·»åŠ ">æ·»åŠ </h2>
<h4 id="adde-element">add(E element)</h4>
<p>æ·»åŠ æ–¹æ³•æœ‰ä¸‰ä¸ªé‡è½½æ–¹æ³•ï¼Œæœ€ç»ˆéƒ½ä¼šè°ƒç”¨ä¸‹é¢è¿™ä¸ª<code>add</code>æ–¹æ³•</p>
<pre><code class="language-java">    private void add(E e, Object[] elementData, int s) {
        if (s == elementData.length)
            elementData = grow();
        elementData[s] = e;
        size = s + 1;
    }
    private Object[] grow() {
        return grow(size + 1);
    }
    private Object[] grow(int minCapacity) {
        return elementData = Arrays.copyOf(elementData,
                                           newCapacity(minCapacity));
    }
	private int newCapacity(int minCapacity) {
        // overflow-conscious code
        int oldCapacity = elementData.length;
        int newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1); // æ¯æ¬¡æ‰©å®¹1.5å€
        //å¦‚æœæ‰©å®¹åçš„capcityçš„å¤§å°ç­‰äºæˆ–å°äºmincapacityï¼Œä¸”å¦‚æœæ˜¯ä½¿ç”¨ç©ºå‚æ„é€ å™¨åˆå§‹åŒ–çš„ï¼Œé‚£ä¹ˆå°±è¿”å›Math.max(DEFAULT_CAPACITY, minCapacity)ï¼Œå¦åˆ™è¿”å› minCapacityï¼ˆif minCapacity &gt; 0)
        if (newCapacity - minCapacity &lt;= 0) {
            if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) // ä½¿ç”¨ç©ºå‚æ„é€ å‡½æ•°elementData=DEFAULTCAPACITY_EMPTY_ELEMENTDATA
                return Math.max(DEFAULT_CAPACITY, minCapacity);
            if (minCapacity &lt; 0) // overflow
                throw new OutOfMemoryError();
            return minCapacity;
        }
        return (newCapacity - MAX_ARRAY_SIZE &lt;= 0)
            ? newCapacity
            : hugeCapacity(minCapacity);
    }	
</code></pre>
<p>åœ¨ç¬¬ä¸€ä¸ªæ–¹æ³•ä¸­ï¼Œ<code>e</code>æ˜¯æŒ‡å½“å‰<code>add</code>çš„å…ƒç´ ï¼Œ<code>s</code>æŒ‡å½“å‰<code>arrList</code>çš„sizeã€‚å¯ä»¥å‘ç°ï¼Œå½“<code>size</code>çš„å¤§å°å’Œ<code>elementData</code>çš„é•¿åº¦ç›¸ç­‰æ—¶ï¼Œæ‰ä¼šè¿›è¡Œæ‰©å®¹ï¼Œå³è°ƒç”¨<code>grow</code>ï¼Œä»<code>newCapacity</code>æ–¹æ³•ä¸­å¯ä»¥å‘ç°ï¼Œæ¯æ¬¡æ‰©å®¹ä¼šæ˜¯å½“å‰<code>size</code>(å³ <code>elementData.length</code>)çš„1.5å€ã€‚</p>
<h4 id="addint-index-e-element">add(int index, E element)</h4>
<pre><code class="language-java"> public void add(int index, E element) {
        rangeCheckForAdd(index);
        modCount++;
        final int s;
        Object[] elementData;
        if ((s = size) == (elementData = this.elementData).length)
            elementData = grow();
        System.arraycopy(elementData, index,
                         elementData, index + 1,
                         s - index);
        elementData[index] = element;
        size = s + 1;
    }
</code></pre>
<p>åœ¨æŒ‡å®šä¸‹æ ‡æ¡ä»¶å…ƒç´ çš„æ­¥éª¤</p>
<ol>
<li>æ£€æŸ¥<code>index</code>ï¼Œå¦‚æœ<code>index</code>å°äº0ï¼Œæˆ–è€…å¤§äº<code>size</code>ï¼Œé‚£ä¹ˆä¼šæŠ›å‡º<code>IndexOutOfBoundsException</code>å¼‚å¸¸</li>
<li><code>modCount++</code>ï¼Œåç»­ä¼šä»‹ç»ç”¨å¤„</li>
<li>åˆ¤æ–­å½“å‰<code>arrayList</code>çš„<code>size</code>å’Œå½“å‰<code>elementData</code>çš„é•¿åº¦æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœç›¸å½“é‚£ä¹ˆå…ˆè¿›è¡Œæ‰©å®¹</li>
<li><code>System.arraycopy</code>è¿›è¡Œå¤åˆ¶ï¼ŒæŠŠ<code>index</code>è¿™ä¸ªä¸‹æ ‡ç©ºå‡ºæ¥</li>
<li>èµ‹å€¼</li>
</ol>
<h2 id="åˆ é™¤">åˆ é™¤</h2>
<h4 id="removeint-index">remove(int index)</h4>
<pre><code class="language-java">    public E remove(int index) {
        Objects.checkIndex(index, size);
        final Object[] es = elementData;

        @SuppressWarnings(&quot;unchecked&quot;) E oldValue = (E) es[index];
        fastRemove(es, index);

        return oldValue;
    }
    private void fastRemove(Object[] es, int i) {
        modCount++;
        final int newSize;
        if ((newSize = size - 1) &gt; i)
            System.arraycopy(es, i + 1, es, i, newSize - i);
        es[size = newSize] = null;
    }
</code></pre>
<p>å¯¹äº<code>remove(int index)</code>æºç å°±æ¯”è¾ƒç®€å•äº†ï¼Œå”¯ä¸€éœ€è¦æ³¨æ„çš„å°±æ˜¯åœ¨<code>fastRemove</code>ä¸­çš„åˆ¤æ–­ï¼Œå¦‚æœéœ€è¦åˆ é™¤çš„æ˜¯æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆç›´æ¥å°†æœ€åä¸€ä¸ªå…ƒç´ è®¾ç½®ä¸º<code>null</code>ï¼Œå¦åˆ™è¿›è¡Œ<code>arraycopy</code>ï¼Œå°†<code>index</code>çš„å€¼è¦†ç›–æ‰ã€‚</p>
<h2 id="å…¶å®ƒ">å…¶å®ƒ</h2>
<h3 id="fail-fast-æœºåˆ¶">Fail-Fast æœºåˆ¶</h3>
<p>å‰é¢æˆ‘ä»¬ç»å¸¸çœ‹åˆ°<code>modCount++</code>çš„æ“ä½œï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¦åŠ è¿™ä¸ªå‘¢ï¼Ÿå…¶å®å½“æ¯æ¬¡å¯¹æ•°ç»„è¿›è¡Œæ“ä½œï¼ˆä¿®æ”¹ï¼‰çš„æ—¶å€™ï¼Œéƒ½ä¼šè¿›è¡Œ<code>modCount++</code>ï¼Œè¿™æ ·åšæ˜¯ä¸ºäº†è®°å½•ä¿®æ”¹æ¬¡æ•°ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“ <code>ArrayList</code> ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå› æ­¤å¦‚æœåœ¨ä½¿ç”¨è¿­ä»£å™¨çš„è¿‡ç¨‹ä¸­å¦‚æœæœ‰å…¶ä»–çº¿ç¨‹ä¿®æ”¹ï¼ˆæ–°å¢/åˆ é™¤ï¼‰äº†<code>arrayList</code>çš„æ•°æ®(æˆ–å½“å‰çº¿ç¨‹åœ¨éå†çš„è¿‡ç¨‹ä¸­å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹)ï¼Œé‚£ä¹ˆå°†æŠ›å‡º<code>ConcurrentModificationException</code>ï¼Œè¿™å°±æ˜¯æ‰€è°“fail-fastç­–ç•¥ã€‚</p>
<p>åœ¨æ¯æ¬¡è¿›è¡Œéå†çš„æ—¶å€™ï¼Œä¼šå…ˆå°†<code>modCount</code>èµ‹å€¼ç»™<code>expectedCount</code>ï¼Œåœ¨è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œè¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœå®ƒä»¬ä¸ç›¸ç­‰ï¼Œåˆ™è¯´æ˜<code>arrayList</code>çš„æ•°æ®å·²ç»è¢«ä¿®æ”¹ï¼ŒæŠ›å‡ºå¼‚å¸¸ã€‚</p>
<h4 id="arrayscopyof-æ–¹æ³•å’Œ-systemarraycopy-æ–¹æ³•çš„åŒºåˆ«">Arrays.copyOf æ–¹æ³•å’Œ System.arraycopy æ–¹æ³•çš„åŒºåˆ«ï¼Ÿ</h4>
<p><code>Arrays.copyOf(T[], int length)</code> æ–¹æ³•æ˜¯ <code>Arrays</code> å·¥å…·ç±»ä¸­ç”¨æ¥è¿›è¡Œä»»æ„ç±»å‹æ•°ç»„èµ‹å€¼ï¼Œå¹¶ä½¿æ•°ç»„å…·æœ‰æŒ‡å®šé•¿åº¦çš„æ–¹æ³•ï¼Œ<code>ArrayList</code> ä¸­ç”¨è¿™ä¸ªæ–¹æ³•æ¥å®ç° <code>elementData</code> æ•°ç»„çš„å…ƒç´ ç§»åŠ¨ã€‚ä½†å®é™…ä¸Š <code>Arrays.copyOf</code> æ–¹æ³•æœ€ç»ˆè°ƒç”¨çš„æ˜¯ <code>System.arraycopy(U[], int srcPos, T[], desPos, int length)</code> æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯ä¸€ä¸ª<code>native</code>æ–¹æ³•</p>
<pre><code class="language-java">    public static native void arraycopy(Object src,  int  srcPos,
                                        Object dest, int destPos,
                                        int length);
</code></pre>
<ul>
<li>src è¡¨ç¤ºçš„æ˜¯åŸå§‹æ•°ç»„ï¼ˆæºæ•°ç»„ï¼‰</li>
<li>dest è¡¨ç¤ºçš„æ˜¯å­˜æ”¾æ‹·è´å€¼çš„æ•°ç»„ï¼ˆç›®æ ‡æ•°ç»„ï¼‰</li>
<li>srcPos æ˜¯æŒ‡åŸå§‹æ•°ç»„ä¸­çš„èµ·å§‹ä½ç½®ï¼ˆä»åŸå§‹æ•°ç»„çš„å“ªä¸ªä½ç½®å¼€å§‹æ‹·è´ï¼‰</li>
<li>desPos æ˜¯æŒ‡å­˜æ”¾æ‹·è´å€¼çš„æ•°ç»„æ‹·è´èµ·å§‹ä½ç½®ï¼ˆä»ç›®æ ‡æ•°ç»„çš„å“ªä¸ªä½ç½®æ’å…¥è¿™äº›æ‹·è´çš„å€¼ï¼‰</li>
<li>length è¡¨ç¤ºè¦æ‹·è´çš„å…ƒç´ æ•°é‡ï¼ˆè¦ä»åŸå§‹æ•°ç»„ä¸­æ‹·è´å¤šå°‘ä¸ªï¼‰ã€‚</li>
</ul>
 </p>
                      </div>
                  </div>

                  <div class="row">
                      <div class="col-md-12 animate-box">
                          
                              <div class="next-post">
                                  <div class="next">ä¸‹ä¸€ç¯‡</div>
                                  <a href="https://aceysx.github.io/post/openjdk-11-yuan-ma-xi-lie-abstractstringbuilderstringbuilderstringbuffer">
                                      <h3 class="post-title">
                                          ã€ŒOpenJdk-11 æºç -ç³»åˆ—ã€AbstractStringBuilder,StringBuilder,StringBuffer
                                      </h3>
                                  </a>
                              </div>
                          
                      </div>
                  </div>

                  <div class="row">
                      <div class="col-md-12 animate-box">
                          
                              
                                  <div id="gitalk-container"></div>
                              

                              
                          
                      </div>
                  </div>
              </div>

          </article>
      </div>
  </div>

    
<footer id="fh5co-footer">
  <p>Powered by xinâ¤ï¸
</p>
</footer>


    <!-- jQuery -->
<script src="https://aceysx.github.io/media/scripts/_vendors/jquery.min.js"></script>
<!-- jQuery Easing -->
<script src="https://aceysx.github.io/media/scripts/_vendors/jquery.easing.1.3.js"></script>
<!-- Bootstrap -->
<script src="https://aceysx.github.io/media/scripts/_vendors/bootstrap.min.js"></script>
<!-- Waypoints -->
<script src="https://aceysx.github.io/media/scripts/_vendors/jquery.waypoints.min.js"></script>
<!-- Main JS -->
<script src="https://aceysx.github.io/media/scripts/_vendors/main.js"></script>
<!-- Md5 Min JS -->
<script src="https://aceysx.github.io/media/scripts/_vendors/md5.min.js"></script>

<script type="application/javascript">
    hljs.initHighlightingOnLoad();
</script>



    
        <script src="https://cdn.bootcss.com/gitalk/1.5.0/gitalk.min.js"></script>
        <script>

            var gitalk = new Gitalk({
                clientID: '6b3df5aab7628f658644',
                clientSecret: '8f262215c4be4b77d5d8dbe4767a1016a95c13d5',
                repo: 'Aceysx.github.io',
                owner: 'Aceysx',
                admin: ['Aceysx'],
                id: md5(location.pathname),      // Ensure uniqueness and length less than 50
                distractionFreeMode: false  // Facebook-like distraction free mode
            })

            gitalk.render('gitalk-container')

        </script>
    

    




  </body>
</html>
